{% load static i18n %}

{% get_current_language as LANGUAGE_CODE %}
{% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
  <head>
    <meta charset="UTF-8">
    <title>Coin Keeper</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
  </head>
  <body>
    <header>
      <div class="logo">Coin Keeper</div>
      <div class="actions">
        <a href="{% url 'login' %}" class="button">{% trans "Login" %}</a>
        <form action="{% url 'set_language' %}" method="post" style="display:inline;">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{ request.get_full_path }}">
          {% if LANGUAGE_CODE == "it" %}
            <input type="hidden" name="language" value="en">
            <button type="submit" class="button">ENG</button>
          {% else %}
            <input type="hidden" name="language" value="it">
            <button type="submit" class="button">ITA</button>
          {% endif %}
        </form>
      </div>
    </header>
    <main>
      <div class="colonna-laterale sinistra"></div>
      <div class="colonna-centrale">
        <div class="box">
          <h1>Coin Keeper</h1>
          <form method="post">
              {% csrf_token %}
              <div class="form__group field">
                  <input type="text" name="username" class="form__field" placeholder="{% trans 'Username' %}" required>
                  <label for="username" class="form__label">{% trans "Username" %}</label>
              </div>
              <div class="form__group field">
                  <input type="email" name="email" class="form__field" placeholder="Email" required>
                  <label for="email" class="form__label">Email</label>
              </div>
              <div class="form__group field">
                  <input type="password" name="password1" class="form__field" placeholder="Password" required>
                  <label for="password1" class="form__label">Password</label>
              </div>
              <div class="form__group field">
                  <input type="password" name="password2" class="form__field" placeholder="{% trans 'Confirm password' %}" required>
                  <label for="password2" class="form__label">{% trans "Confirm password" %}</label>
              </div>
              <div class="form__group field">
                <button type="submit" class="button button--primary">{% trans "Sign up" %}</button>
              </div>
          </form>
        </div>
      </div>
      <div class="colonna-laterale destra"></div>
    </main>
    <script>
      const pwd1 = document.querySelector('input[name="password1"]');
      const pwd2 = document.querySelector('input[name="password2"]');
      const btn = document.getElementsByClassName('button--primary')[0];
      function checkPasswords() {
        if (pwd1.value && pwd1.value === pwd2.value) {
          btn.disabled = false;
        } else {
          btn.disabled = true;
        }
      }
      pwd1.addEventListener("input", checkPasswords);
      pwd2.addEventListener("input", checkPasswords);
      btn.disabled = true;
    </script>
  </body>
</html>
